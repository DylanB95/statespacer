<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>State Space Model Fitting — StateSpaceFit • statespacer</title>

<!-- favicons -->
<link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png" />
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png" />
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png" />
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png" />

<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="State Space Model Fitting — StateSpaceFit" />
<meta property="og:description" content="Fits a State Space model as specified by the user." />
<meta property="og:image" content="https://dylanb95.github.io/statespacer/logo.png" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">statespacer</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/dictionary.html">Dictionary of statespacer</a>
    </li>
    <li>
      <a href="../articles/intro.html">Introduction to statespacer</a>
    </li>
    <li>
      <a href="../articles/seatbelt.html">State Space models applied to the UK Road Deaths dataset</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/DylanB95/statespacer/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>State Space Model Fitting</h1>
    <small class="dont-index">Source: <a href='https://github.com/DylanB95/statespacer/blob/master/R/StateSpaceFit.R'><code>R/StateSpaceFit.R</code></a></small>
    <div class="hidden name"><code>StateSpaceFit.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Fits a State Space model as specified by the user.</p>
    </div>

    <pre class="usage"><span class='fu'>StateSpaceFit</span>(
  <span class='no'>y</span>,
  <span class='kw'>H_format</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>local_level_ind</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>,
  <span class='kw'>slope_ind</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>,
  <span class='kw'>BSM_vec</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>cycle_ind</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>,
  <span class='kw'>addvar_list</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>level_addvar_list</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>arima_list</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>sarima_list</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>exclude_level</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>exclude_slope</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>exclude_BSM_list</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/lapply.html'>lapply</a></span>(<span class='no'>BSM_vec</span>, <span class='kw'>FUN</span> <span class='kw'>=</span> <span class='kw'>function</span>(<span class='no'>x</span>) <span class='fl'>0</span>),
  <span class='kw'>exclude_cycle_list</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>(<span class='fl'>0</span>),
  <span class='kw'>exclude_arima_list</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/lapply.html'>lapply</a></span>(<span class='no'>arima_list</span>, <span class='kw'>FUN</span> <span class='kw'>=</span> <span class='kw'>function</span>(<span class='no'>x</span>) <span class='fl'>0</span>),
  <span class='kw'>exclude_sarima_list</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/lapply.html'>lapply</a></span>(<span class='no'>sarima_list</span>, <span class='kw'>FUN</span> <span class='kw'>=</span> <span class='kw'>function</span>(<span class='no'>x</span>) <span class='fl'>0</span>),
  <span class='kw'>damping_factor_ind</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span>(<span class='fl'>TRUE</span>, <span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span>(<span class='no'>exclude_cycle_list</span>)),
  <span class='kw'>format_level</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>format_slope</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>format_BSM_list</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/lapply.html'>lapply</a></span>(<span class='no'>BSM_vec</span>, <span class='kw'>FUN</span> <span class='kw'>=</span> <span class='kw'>function</span>(<span class='no'>x</span>) <span class='kw'>NULL</span>),
  <span class='kw'>format_cycle_list</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/lapply.html'>lapply</a></span>(<span class='no'>exclude_cycle_list</span>, <span class='kw'>FUN</span> <span class='kw'>=</span> <span class='kw'>function</span>(<span class='no'>x</span>) <span class='kw'>NULL</span>),
  <span class='kw'>format_addvar</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>format_level_addvar</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>method</span> <span class='kw'>=</span> <span class='st'>"BFGS"</span>,
  <span class='kw'>initial</span> <span class='kw'>=</span> <span class='fl'>0</span>,
  <span class='kw'>control</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>()
)</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>y</th>
      <td><p>N x p matrix containing the N observations of the p
dependent variables.</p></td>
    </tr>
    <tr>
      <th>H_format</th>
      <td><p>Format of the H system matrix,
the variance - covariance matrix of the observation equation.</p></td>
    </tr>
    <tr>
      <th>local_level_ind</th>
      <td><p>Boolean indicating whether a local level should
be added to the state space model.</p></td>
    </tr>
    <tr>
      <th>slope_ind</th>
      <td><p>Boolean indicating whether a local level + slope should
be added to the state space model.</p></td>
    </tr>
    <tr>
      <th>BSM_vec</th>
      <td><p>Vector containing the BSM seasonalities that have to be added
to the state space model.</p></td>
    </tr>
    <tr>
      <th>cycle_ind</th>
      <td><p>Boolean indicating whether a cycle has to be added
to the state space model.</p></td>
    </tr>
    <tr>
      <th>addvar_list</th>
      <td><p>A list containing the explanatory variables for each of
the dependent variables. The list should contain p (number of dependent
variables) elements. Each element of the list should be a N x k_p matrix,
with k_p being the number of explanatory variables for the pth
dependent variable. If no explanatory variables should be added for one
of the dependent variables, then set the corresponding element to <code>NULL</code>.</p></td>
    </tr>
    <tr>
      <th>level_addvar_list</th>
      <td><p>A list containing the explanatory variables for
each of the dependent variables. The list should contain p (number of
dependent variables) elements. Each element of the list should be a
N x k_p matrix, with k_p being the number of explanatory variables
for the pth dependent variable. If no explanatory variables should be
added for one of the dependent variables, then set the corresponding
element to <code>NULL</code>.</p></td>
    </tr>
    <tr>
      <th>arima_list</th>
      <td><p>Specifications of the ARIMA components, should be a list
containing vectors of length 3 with the following format: c(AR, I, MA).
Should be a list to allow different ARIMA models for different sets of
dependent variables. Note: The AR and MA coefficients are
constrained such that the AR component is stationary, and the MA
component is invertible.
See Ansley and Kohn (1986)
 for details about
the transformation used.</p></td>
    </tr>
    <tr>
      <th>sarima_list</th>
      <td><p>Specifications of the SARIMA components, should be a list
containing lists that contain 4 named vectors. Vectors should be named:
"s", "ar", "i", "ma". Should be a list of lists to allow different SARIMA
models for different sets of dependent variables. Note: The AR and MA
coefficients are constrained such that the AR components are stationary,
and the MA components are invertible.
See Ansley and Kohn (1986)
 for details about
the transformation used.</p></td>
    </tr>
    <tr>
      <th>exclude_level</th>
      <td><p>Vector containing the dependent variables that should
not get a local level.</p></td>
    </tr>
    <tr>
      <th>exclude_slope</th>
      <td><p>Vector containing the dependent variables that should
not get a slope.</p></td>
    </tr>
    <tr>
      <th>exclude_BSM_list</th>
      <td><p>List of vectors, each vector containing the
dependent variables that should not get the corresponding BSM component.</p></td>
    </tr>
    <tr>
      <th>exclude_cycle_list</th>
      <td><p>The dependent variables that should not get the
corresponding cycle component. Should be a list of vectors to allow
different dependent variables to be excluded for different cycles.</p></td>
    </tr>
    <tr>
      <th>exclude_arima_list</th>
      <td><p>The dependent variables that should not be
involved in the corresponding ARIMA component. Should be a list of
vectors to allow different dependent variables to be excluded for
different ARIMA components.</p></td>
    </tr>
    <tr>
      <th>exclude_sarima_list</th>
      <td><p>The dependent variables that should not be
involved in the corresponding SARIMA component. Should be a list of
vectors to allow different dependent variables to be excluded for
different SARIMA components.</p></td>
    </tr>
    <tr>
      <th>damping_factor_ind</th>
      <td><p>Boolean indicating whether a damping factor should
be included. Must be a vector if multiple cycles are included,
to indicate which cycles should include a damping factor.</p></td>
    </tr>
    <tr>
      <th>format_level</th>
      <td><p>Format of the Q_level system matrix
the variance - covariance matrix of the level state equation.</p></td>
    </tr>
    <tr>
      <th>format_slope</th>
      <td><p>Format of the Q_slope system matrix,
the variance - covariance matrix of the slope state equation.</p></td>
    </tr>
    <tr>
      <th>format_BSM_list</th>
      <td><p>Format of the Q_BSM system matrix,
the variance - covariance matrix of the BSM state equation. Should be a
list to allow different formats for different seasonality periods.</p></td>
    </tr>
    <tr>
      <th>format_cycle_list</th>
      <td><p>Format of the Q_cycle system matrix,
the variance - covariance matrix of the cycle state equation. Should be a
list to allow different formats for different cycles.</p></td>
    </tr>
    <tr>
      <th>format_addvar</th>
      <td><p>Format of the Q_addvar system matrix, the
variance - covariance matrix of the explanatory variables state equation.</p></td>
    </tr>
    <tr>
      <th>format_level_addvar</th>
      <td><p>Format of the Q_level_addvar system matrix, the
variance - covariance matrix of the explanatory variables of the level
state equation.</p></td>
    </tr>
    <tr>
      <th>method</th>
      <td><p>Method that should be used by the <code><a href='https://rdrr.io/r/stats/optim.html'>optim</a></code>
or <code><a href='https://rdrr.io/pkg/optimx/man/optimr.html'>optimr</a></code> function to estimate the parameters.</p></td>
    </tr>
    <tr>
      <th>initial</th>
      <td><p>Initial values for the parameter search, allowed to be a
vector or just one number.</p></td>
    </tr>
    <tr>
      <th>control</th>
      <td><p>A list of control parameters for the
<code><a href='https://rdrr.io/r/stats/optim.html'>optim</a></code> or <code><a href='https://rdrr.io/pkg/optimx/man/optimr.html'>optimr</a></code> function.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>A list containing:</p><ul>
<li><p>function_call: A list containing the input to the function.</p></li>
<li><p>system_matrices: A list containing the system matrices of
the State Space model.</p></li>
<li><p>predicted: A list containing the predicted components of
the State Space model.</p></li>
<li><p>filtered: A list containing the filtered components of
the State Space model.</p></li>
<li><p>smoothed: A list containing the smoothed components of
the State Space model.</p></li>
<li><p>diagnostics: A list containing items useful for diagnostical tests.</p></li>
<li><p>optim: A list containing the variables that are returned by the
<code><a href='https://rdrr.io/r/stats/optim.html'>optim</a></code> or <code><a href='https://rdrr.io/pkg/optimx/man/optimr.html'>optimr</a></code> function.</p></li>
<li><p>loglik_fun: Function that returns the loglikelihood of the
specified State Space model, as a function of its parameters.</p></li>
<li><p>standard_errors: A list containing the standard errors of
the parameters of the State Space model.</p></li>
</ul>

<p>For extensive details about the object returned,
see <code><a href='../articles/dictionary.html'>vignette("dictionary", package = "statespacer")</a></code>.</p>
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>To fit the specified State Space model, it might be beneficial to scale
the dependent variables or pay careful attention to the initial values.
If an error occurs, try to scale the dependents by a bigger number, or
try different initial values. Initial values should not be too big, as
some parameters use the transformation exp(2x) to ensure non-negative
values, they should also not be too small as some variances might be
relatively close to 0, relative to the magnitude of y.
Note: after fitting the model, remember to scale the estimates back!
Variances should be multiplied by the square of the scaling number!</p>
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Durbin J, Koopman SJ (2012).
<em>Time series analysis by state space methods</em>.
Oxford university press.</p>
<p>Ansley CF, Kohn R (1986).
&#8220;A note on reparameterizing a vector autoregressive moving average model to enforce stationarity.&#8221;
<em>Journal of Statistical Computation and Simulation</em>, <b>24</b>(2), 99--106.</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'># Fits a local level model for the Nile data</span>
<span class='fu'><a href='https://rdrr.io/r/base/library.html'>library</a></span>(<span class='no'>datasets</span>)
<span class='no'>y</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span>(<span class='no'>Nile</span>)
<span class='no'>fit</span> <span class='kw'>&lt;-</span> <span class='fu'>StateSpaceFit</span>(<span class='kw'>initial</span> <span class='kw'>=</span> <span class='fl'>1</span>, <span class='kw'>y</span> <span class='kw'>=</span> <span class='no'>y</span> / <span class='fl'>100</span>, <span class='kw'>local_level_ind</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>)</div><div class='output co'>#&gt; <span class='warning'>Warning: Number of initial parameters is less than the required amount of parameters (2), recycling the initial parameters the required amount of times.</span></div><div class='output co'>#&gt; <span class='message'>Starting the optimisation procedure at: 2020-04-26 02:29:18</span></div><div class='output co'>#&gt; Parameter scaling:[1] 1 1
#&gt; initial  value 2.443183 
#&gt; iter  10 value 1.775548
#&gt; final  value 1.775527 
#&gt; converged</div><div class='output co'>#&gt; <span class='message'>Finished the optimisation procedure at: 2020-04-26 02:29:19</span></div><div class='output co'>#&gt; <span class='message'>Time difference of 0.438907861709595 secs</span></div><div class='input'>
<span class='co'># Plots the filtered estimates</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.html'>plot</a></span>(<span class='fl'>1871</span>:<span class='fl'>1970</span>, <span class='fl'>100</span> * <span class='no'>fit</span>$<span class='no'>function_call</span>$<span class='no'>y</span>, <span class='kw'>type</span> <span class='kw'>=</span> <span class='st'>'p'</span>,
     <span class='kw'>ylim</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>500</span>, <span class='fl'>1400</span>), <span class='kw'>xlab</span> <span class='kw'>=</span> <span class='fl'>NA</span>, <span class='kw'>ylab</span> <span class='kw'>=</span> <span class='fl'>NA</span>)</div><div class='input'><span class='fu'><a href='https://rdrr.io/r/graphics/lines.html'>lines</a></span>(<span class='fl'>1871</span>:<span class='fl'>1970</span>, <span class='fl'>100</span> * <span class='no'>fit</span>$<span class='no'>filtered</span>$<span class='no'>level</span>, <span class='kw'>type</span> <span class='kw'>=</span> <span class='st'>'l'</span>)</div><div class='input'><span class='fu'><a href='https://rdrr.io/r/graphics/lines.html'>lines</a></span>(<span class='fl'>1871</span>:<span class='fl'>1970</span>, <span class='fl'>100</span> * <span class='no'>fit</span>$<span class='no'>filtered</span>$<span class='no'>level</span> +
                 <span class='fl'>1.644854</span> * <span class='fl'>100</span> * <span class='fu'><a href='https://rdrr.io/r/base/MathFun.html'>sqrt</a></span>(<span class='no'>fit</span>$<span class='no'>filtered</span>$<span class='no'>P</span>[<span class='fl'>1</span>,<span class='fl'>1</span>,]),
      <span class='kw'>type</span> <span class='kw'>=</span> <span class='st'>'l'</span>, <span class='kw'>col</span> <span class='kw'>=</span> <span class='st'>'gray'</span>)</div><div class='input'><span class='fu'><a href='https://rdrr.io/r/graphics/lines.html'>lines</a></span>(<span class='fl'>1871</span>:<span class='fl'>1970</span>, <span class='fl'>100</span> * <span class='no'>fit</span>$<span class='no'>filtered</span>$<span class='no'>level</span> -
                 <span class='fl'>1.644854</span> * <span class='fl'>100</span> * <span class='fu'><a href='https://rdrr.io/r/base/MathFun.html'>sqrt</a></span>(<span class='no'>fit</span>$<span class='no'>filtered</span>$<span class='no'>P</span>[<span class='fl'>1</span>,<span class='fl'>1</span>,]),
      <span class='kw'>type</span> <span class='kw'>=</span> <span class='st'>'l'</span>, <span class='kw'>col</span> <span class='kw'>=</span> <span class='st'>'gray'</span>)</div><div class='img'><img src='StateSpaceFit-1.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'># Plots the smoothed estimates</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.html'>plot</a></span>(<span class='fl'>1871</span>:<span class='fl'>1970</span>, <span class='fl'>100</span> * <span class='no'>fit</span>$<span class='no'>function_call</span>$<span class='no'>y</span>, <span class='kw'>type</span> <span class='kw'>=</span> <span class='st'>'p'</span>,
     <span class='kw'>ylim</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>500</span>, <span class='fl'>1400</span>), <span class='kw'>xlab</span> <span class='kw'>=</span> <span class='fl'>NA</span>, <span class='kw'>ylab</span> <span class='kw'>=</span> <span class='fl'>NA</span>)</div><div class='input'><span class='fu'><a href='https://rdrr.io/r/graphics/lines.html'>lines</a></span>(<span class='fl'>1871</span>:<span class='fl'>1970</span>, <span class='fl'>100</span> * <span class='no'>fit</span>$<span class='no'>smoothed</span>$<span class='no'>level</span>,<span class='kw'>type</span><span class='kw'>=</span><span class='st'>'l'</span>)</div><div class='input'><span class='fu'><a href='https://rdrr.io/r/graphics/lines.html'>lines</a></span>(<span class='fl'>1871</span>:<span class='fl'>1970</span>, <span class='fl'>100</span> * <span class='no'>fit</span>$<span class='no'>smoothed</span>$<span class='no'>level</span> +
                 <span class='fl'>1.644854</span> * <span class='fl'>100</span> * <span class='fu'><a href='https://rdrr.io/r/base/MathFun.html'>sqrt</a></span>(<span class='no'>fit</span>$<span class='no'>smoothed</span>$<span class='no'>V</span>[<span class='fl'>1</span>,<span class='fl'>1</span>,]),
      <span class='kw'>type</span> <span class='kw'>=</span> <span class='st'>'l'</span>, <span class='kw'>col</span> <span class='kw'>=</span> <span class='st'>'gray'</span>)</div><div class='input'><span class='fu'><a href='https://rdrr.io/r/graphics/lines.html'>lines</a></span>(<span class='fl'>1871</span>:<span class='fl'>1970</span>, <span class='fl'>100</span> * <span class='no'>fit</span>$<span class='no'>smoothed</span>$<span class='no'>level</span> -
                 <span class='fl'>1.644854</span> * <span class='fl'>100</span> * <span class='fu'><a href='https://rdrr.io/r/base/MathFun.html'>sqrt</a></span>(<span class='no'>fit</span>$<span class='no'>smoothed</span>$<span class='no'>V</span>[<span class='fl'>1</span>,<span class='fl'>1</span>,]),
      <span class='kw'>type</span> <span class='kw'>=</span> <span class='st'>'l'</span>, <span class='kw'>col</span> <span class='kw'>=</span> <span class='st'>'gray'</span>)</div><div class='img'><img src='StateSpaceFit-2.png' alt='' width='700' height='433' /></div><div class='input'>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Dylan Beijers.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


